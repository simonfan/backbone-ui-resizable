//     backbone-ui-resizable
//     (c) simonfan
//     backbone-ui-resizable is licensed under the MIT terms.

define("__backbone-ui-resizable/handle/helpers",["require","exports","module","lodash"],function(e,i){var t=e("lodash");i.min=function(e,i){return isNaN(e)?i:isNaN(i)?e:i>e?e:i},i.max=function(e,i){return isNaN(e)?i:isNaN(i)?e:e>i?e:i},i.numberify=function(e){var i=parseFloat(e);if(isNaN(i))throw new Error(e+" not number");return i},i.numberifyProperties=function(e,i){var s={};return t.each(e,function(e){s[e]=parseFloat(i[e])}),s};var s=/^-?\d*(\.\d+)?$/;i.stringifyPositionalValue=function(e){return s.test(e)?e+"px":e}}),define("__backbone-ui-resizable/handle/update-position",["require","exports","module","./helpers","no"],function(e,i){function t(e){var i=o(this.resizable.model.get("top")).add(e);this.model.set("top",i.value())}function s(e){var i=o(this.resizable.model.get("top"));i.add(this.resizable.model.get("height")).add(e),this.model.set("top",i.value())}function a(e){var i=o(this.resizable.model.get("left"));this.model.set("left",i.add(e).value())}function n(e){var i=o(this.resizable.model.get("left"));i.add(this.resizable.model.get("width")).add(e),this.model.set("left",i.value())}function l(){this.model.set("width",o(this.resizable.model.get("width")).value())}function h(){this.model.set("height",o(this.resizable.model.get("height")).value())}var o=(e("./helpers"),e("no"));i.n=function(){t.call(this,-1*this.outer),a.call(this,0),l.call(this)},i.s=function(){s.call(this,-1*this.inner),a.call(this,0),l.call(this)},i.w=function(){a.call(this,-1*this.outer),t.call(this,0),h.call(this)},i.e=function(){n.call(this,-1*this.inner),t.call(this,0),h.call(this)},i.nw=function(){t.call(this,-1*this.outer),a.call(this,-1*this.outer)},i.ne=function(){t.call(this,-1*this.outer),n.call(this,-1*this.inner)},i.sw=function(){s.call(this,-1*this.inner),a.call(this,-1*this.outer)},i.se=function(){s.call(this,-1*this.inner),n.call(this,-1*this.inner)}}),define("__backbone-ui-resizable/handle/track",["require","exports","module","lodash","./helpers"],function(e,i){var t=e("lodash"),s=e("./helpers");i.all=function(){var e=this.resizable;e.listenTo(this,"movestart",function(){this.trigger("resizestart",e)}),e.listenTo(this,"movestop",function(){this.trigger("resizestop",e)}),this.listenTo(e.model,"change",this.updatePosition)},i.n=function(){var e=this.resizable,i=this.direction;e.listenTo(this,"move-y",function(e,a){var n=this.model,l=s.numberify(a.delta),h=s.numberify(n.get("height")),o=s.numberify(n.get("top"));if(n.set({height:h-l,top:o+l}),!a.silent){var r=l>0?"contract":"expand";a=t.assign({action:r,handle:i},a),this.trigger("resize",this,a).trigger("resize-y",this,a).trigger(r,this,a).trigger(r+"y",this,a)}},e)},i.s=function(){var e=this.resizable,i=this.direction;e.listenTo(this,"move-y",function(e,a){var n=this.model,l=s.numberify(n.get("height"))+s.numberify(a.delta);if(n.set("height",l),!a.silent){var h=a.delta>0?"expand":"contract";a=t.assign({action:h,handle:i},a),this.trigger("resize",this,a).trigger("resize-y",this,a).trigger(h,this,a).trigger(h+"y",this,a)}},e)},i.w=function(){var e=this.resizable,i=this.direction;e.listenTo(this,"move-x",function(e,a){var n=this.model,l=s.numberify(a.delta),h=s.numberify(n.get("width")),o=s.numberify(n.get("left"));if(n.set({width:h-l,left:o+l}),!a.silent){var r=l>0?"contract":"expand";a=t.assign({action:r,handle:i},a),this.trigger("resize",this,a).trigger("resize-x",this,a).trigger(r,this,a).trigger(r+"x",this,a)}},e)},i.e=function(){var e=this.resizable,i=this.direction;e.listenTo(this,"move-x",function(e,a){var n=this.model,l=s.numberify(n.get("width"))+s.numberify(a.delta);if(n.set("width",l),!a.silent){var h=a.delta>0?"expand":"contract";a=t.assign({action:h,handle:i},a),this.trigger("resize",this,a).trigger("resize-x",this,a).trigger(h,this,a).trigger(h+"x",this,a)}},e)}}),define("__backbone-ui-resizable/handle/min-max",["require","exports","module","no","./helpers"],function(e,i){var t=e("no"),s=e("./helpers");i.n=function(){var e=this.resizable.model,i=e.get("height"),a=e.get("minHeight"),n=e.get("maxHeight"),l=n-i,h=i-a,o=e.get("minTop")||0,r=e.get("maxTop"),d=this.model.get("top");this.model.set({minTop:s.max(t(d).subtract(l).subtract(this.outer).value(),t(o).subtract(this.outer).value()),maxTop:s.min(t(d).add(h).subtract(this.outer).value(),t(r).subtract(this.outer).value())})},i.s=function(){var e=this.resizable.model,i=e.get("height"),a=e.get("minHeight"),n=e.get("maxHeight"),l=i-a,h=n-i,o=e.get("minBottom"),r=e.get("maxBottom"),d=this.model.get("top");this.model.set({minBottom:s.max(t(d).subtract(l).add(this.thickness).value(),t(o).add(this.outer).value()),maxBottom:s.min(t(d).add(h).add(this.thickness).value(),t(r).add(this.outer).value())})},i.w=function(){var e=this.resizable.model,i=e.get("width"),a=e.get("minWidth"),n=e.get("maxWidth"),l=n-i,h=i-a,o=e.get("minLeft")||0,r=e.get("maxLeft"),d=this.model.get("left");this.model.set({minLeft:s.max(t(d).subtract(l).subtract(this.outer).value(),t(o).subtract(this.outer).value()),maxLeft:s.min(t(d).add(h).subtract(this.outer).value(),t(r).subtract(this.outer).value())})},i.e=function(){var e=this.resizable.model,i=e.get("width"),a=e.get("minWidth"),n=e.get("maxWidth"),l=i-a,h=n-i,o=e.get("minRight"),r=e.get("maxRight"),d=this.model.get("left");this.model.set({minRight:s.max(t(d).subtract(l).add(this.thickness).value(),t(o).add(this.outer).value()),maxRight:s.min(t(d).add(this.thickness).add(h).value(),t(r).add(this.outer).value())})}}),define("__backbone-ui-resizable/handle/enable-disable",["require","exports","module"],function(e,i){i.disableHandle=function(){return this.disableDraggable(),this.$el.addClass(this.resizable.handleOptions.clss+"-disabled").removeClass(this.resizable.handleOptions.clss+"-enabled"),this},i.enableHandle=function(){return this.enableDraggable(),this.$el.addClass(this.resizable.handleOptions.clss+"-enabled").removeClass(this.resizable.handleOptions.clss+"-disabled"),this}}),define("__backbone-ui-resizable/handle/index",["require","exports","module","jquery-ui","backbone-ui-draggable","lodash","./update-position","./track","./min-max","./enable-disable"],function(e,i,t){e("jquery-ui");var s=e("backbone-ui-draggable"),a=e("lodash"),n=e("./update-position"),l=e("./track"),h=e("./min-max"),o={n:"left top",s:"left bottom",w:"left top",e:"right top",nw:"left top",ne:"right top",sw:"left bottom",se:"right bottom"},r={n:"y",s:"y",w:"x",e:"x",nw:"xy",ne:"xy",sw:"xy",se:"xy"},d=t.exports=s.extend({initialize:function(e){s.prototype.initialize.call(this,e),this.initializeResizableHandle(e)},initializeResizableHandle:function(e){this.resizable=e.resizable,this.direction=e.direction,this.axis=r[this.direction],this.thickness=e.thickness,this.ratio=e.ratio,this.outer=e.thickness*this.ratio,this.inner=e.thickness-this.outer,this.updatePosition=a.throttle(a.bind(n[this.direction],this),20),this.setStyles(),this.initializePosition(e),this.track(),this.on("movestart",this.calcMinMax),this.enableHandle()},setStyles:function(){var e,i=this.axis;i.length>1?e={zIndex:100,width:this.thickness,height:this.thickness}:"x"===i?e={zIndex:99,width:this.thickness,height:this.resizable.model.get("width")}:"y"===i&&(e={zIndex:99,width:this.resizable.model.get("height"),height:this.thickness}),this.$el.css(e)},initializePosition:function(){var e=this.$el;e.position({my:"center center",at:o[this.direction],of:this.resizable.$el});var i=e.position();this.model.set({top:parseFloat(i.top),left:parseFloat(i.left)}),this.updatePosition()},track:function(){a.each(this.direction,function(e){l[e].call(this)},this),l.all.call(this)},calcMinMax:function(){a.each(this.direction,function(e){h[e].call(this)},this)},map:a.extend(s.prototype.map,{height:"->css:height",width:"->css:width"})});d.proto(e("./enable-disable"))}),define("__backbone-ui-resizable/actions",["require","exports","module"],function(e,i){i.expandToLeft=function(e,i){i=i||{},i.agent=i.agent||"code";var t=this.handles.w;return t.calcMinMax(),t.moveToLeft(e,i)},i.expandToRight=function(e,i){i=i||{},i.agent=i.agent||"code";var t=this.handles.e;return t.calcMinMax(),t.moveToRight(e,i)},i.expandToTop=function(e,i){i=i||{},i.agent=i.agent||"code";var t=this.handles.n;return t.calcMinMax(),t.moveToTop(e,i)},i.expandToBottom=function(e,i){i=i||{},i.agent=i.agent||"code";var t=this.handles.s;return t.calcMinMax(),t.moveToBottom(e,i)},i.contractToRight=function(e,i){i=i||{},i.agent=i.agent||"code";var t=this.handles.w;return t.calcMinMax(),t.moveToRight(e,i)},i.contractToLeft=function(e,i){i=i||{},i.agent=i.agent||"code";var t=this.handles.e;return t.calcMinMax(),t.moveToLeft(e,i)},i.contractToBottom=function(e,i){i=i||{},i.agent=i.agent||"code";var t=this.handles.n;return t.calcMinMax(),t.moveToBottom(e,i)},i.contractToTop=function(e,i){i=i||{},i.agent=i.agent||"code";var t=this.handles.s;return t.calcMinMax(),t.moveToTop(e,i)}}),define("__backbone-ui-resizable/enable-disable",["require","exports","module"],function(e,i){i.disableResizable=function(){return _.each(this.handles,function(e){e.disableHandle()},this),this.$el.addClass(this.resizableClass+"-disabled").removeClass(this.resizableClass+"-enabled"),this},i.enableResizable=function(){return _.each(this.handles,function(e){e.enableHandle()},this),this.$el.addClass(this.resizableClass+"-enabled").removeClass(this.resizableClass+"-disabled"),this},i.disableHandle=function(e){var i=this.handles[e];return i&&i.disableHandle(),this},i.enableHandle=function(e,i){var t=this.handles[e];return t?t.enableHandle():this.handles[e]=this.buildHandle(e,i),this}}),define("__backbone-ui-resizable/build-handle",["require","exports","module","jquery","lodash"],function(e,i){var t=e("jquery"),s=e("lodash");i.buildHandle$El=function(e,i){var s=i.clss,a=t("<div></div>");return a.addClass(s).addClass(s+"-"+e),a.insertAfter(this.$el)},i.buildHandle=function(e,i){i=i||{},s.defaults(i,this.handleOptions);var t=i.ratio,a=i.thickness,n=s.extend({},i,{el:this.buildHandle$El(e,i),resizable:this,direction:e,ratio:s.isObject(t)?t[e]:t,thickness:s.isObject(a)?a[e]:a}),l=this.handleBuilder(n);return l}}),define("backbone-ui-resizable",["require","exports","module","lowercase-backbone","backbone-ui-draggable","jquery","lodash","./__backbone-ui-resizable/handle/index","./__backbone-ui-resizable/handle/helpers","./__backbone-ui-resizable/actions","./__backbone-ui-resizable/enable-disable","./__backbone-ui-resizable/build-handle"],function(e,i,t){var s=e("lowercase-backbone"),a=e("backbone-ui-draggable"),n=e("jquery"),l=e("lodash"),h=e("./__backbone-ui-resizable/handle/index"),o=e("./__backbone-ui-resizable/handle/helpers"),r=t.exports=a.extend({initialize:function(e){s.view.prototype.initialize.call(this,e),this.initializeModelDock(e),this.initializeUIDraggable(e),this.initializeUIResizable(e)},initializeUIResizable:function(e){this.$canvas=e.canvas||this.canvas||n(window),e.enableDraggable||this.disableDraggable();var i=l.extend({minWidth:2*this.handleOptions.thickness,minHeight:2*this.handleOptions.thickness,width:this.$el.width(),height:this.$el.height()},this.$el.position(),e);this.model.set(i),this.handleOptions=l.extend(this.handleOptions,l.pick(e,["clss","ratio","thickness"]));var t=e.handles||this.handles;t=l.isArray(t)?t:t.split(","),this.handles={},l.each(t,function(e){this.handles[e]=this.buildHandle(e,this.handleOptions)},this)},handleBuilder:h,handles:"n,s,w,e,nw,ne,sw,se",handleOptions:{clss:"handle",ratio:.2,thickness:30},stringifiers:{height:o.stringifyPositionalValue,minHeight:o.stringifyPositionalValue,maxHeight:o.stringifyPositionalValue,width:o.stringifyPositionalValue,minWidth:o.stringifyPositionalValue,maxWidth:o.stringifyPositionalValue,left:o.stringifyPositionalValue,top:o.stringifyPositionalValue},map:{top:"->css:top",left:"->css:left",width:"->css:width",minWidth:"->css:min-width",maxWidth:"->css:max-width",height:"->css:height",minHeight:"->css:min-height",maxHeight:"->css:max-height"}});r.proto(e("./__backbone-ui-resizable/actions")),r.proto(e("./__backbone-ui-resizable/enable-disable")),r.proto(e("./__backbone-ui-resizable/build-handle"))});